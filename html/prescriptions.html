<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prescriptions - MediCare Doctor Dashboard</title>
    
    <!-- CSS Files -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/prescription.css">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="MediCare Doctor Dashboard - Prescription Management System">
    <meta name="keywords" content="prescription management, medical prescriptions, digital prescriptions">
    <meta name="author" content="MediCare Team">
    <meta name="robots" content="noindex, nofollow">
    <meta name="theme-color" content="#43a047">
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <img src="../img/logo-nobg.png" alt="MediCare">
            </div>
            <span class="brand-text">MediCare</span>
        </div>
        
        <nav class="sidebar-nav">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link" href="doctor-dashboard.html">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="appointment.html">
                        <i class="fas fa-calendar-check"></i>
                        <span>Appointments</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="patient-page.html">
                        <i class="fas fa-user-injured"></i>
                        <span>Patients</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="prescriptions.html">
                        <i class="fas fa-prescription-bottle-alt"></i>
                        <span>Prescriptions</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="lab-results.html">
                        <i class="fas fa-flask"></i>
                        <span>Lab Results</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#messages">
                        <i class="fas fa-comments"></i>
                        <span>Messages</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#schedule">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Schedule</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#reports">
                        <i class="fas fa-chart-bar"></i>
                        <span>Reports</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="doctor-profile.html">
                        <i class="fas fa-user-md"></i>
                        <span>Profile</span>
                    </a>
                </li>
            </ul>
        </nav>
    </aside>

    <!-- Mobile Sidebar Backdrop -->
    <div class="sidebar-backdrop" id="sidebarBackdrop"></div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Top Navigation -->
        <nav class="top-nav">
            <div class="nav-left">
                <button class="sidebar-toggle" id="sidebarToggle">
                    <i class="fas fa-bars"></i>
                </button>
                
                <div class="search-bar">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Search prescriptions, patients, or medications..." id="globalSearch">
                </div>
            </div>
            
            <div class="nav-right">
                <button class="nav-item-btn" title="Emergency Alerts" id="emergencyBtn">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span class="notification-badge">2</span>
                </button>
                
                <button class="nav-item-btn" title="Messages" id="messagesBtn">
                    <i class="fas fa-envelope"></i>
                    <span class="notification-badge">5</span>
                </button>
                
                <button class="nav-item-btn" title="Notifications" id="notificationsBtn">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge">12</span>
                </button>
                
                <button class="theme-toggle" id="themeToggle" title="Toggle Dark Mode">
                    <i class="fas fa-moon" id="themeIcon"></i>
                </button>
                
                <div class="dropdown">
                    <div class="user-profile" data-bs-toggle="dropdown">
                        <div class="user-avatar">DR</div>
                        <div class="user-info">
                            <h6>Dr. Rajesh Kumar</h6>
                            <span>Cardiologist</span>
                        </div>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="doctor-profile.html"><i class="fas fa-user"></i>My Profile</a></li>
                        <li><a class="dropdown-item" href="#account"><i class="fas fa-user-cog"></i>Account Settings</a></li>
                        <li><a class="dropdown-item" href="#help"><i class="fas fa-question-circle"></i>Help & Support</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="doctor-login.html"><i class="fas fa-sign-out-alt"></i>Logout</a></li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- Prescriptions Content -->
        <div class="prescriptions-content">
            <!-- Page Header -->
            <div class="page-header">
                <div class="header-left">
                    <h1 class="page-title">Prescription Management</h1>
                    <p class="page-subtitle">Create, manage, and track digital prescriptions for your patients</p>
                </div>
                <div class="header-right">
                    <button class="btn btn-primary" id="createPrescriptionBtn">
                        <i class="fas fa-plus"></i> Create Prescription
                    </button>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="stats-row">
                <div class="stat-card">
                    <div class="stat-icon total">
                        <i class="fas fa-prescription"></i>
                    </div>
                    <div class="stat-details">
                        <h3 id="totalPrescriptions">156</h3>
                        <span>Total Prescriptions</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon today">
                        <i class="fas fa-calendar-day"></i>
                    </div>
                    <div class="stat-details">
                        <h3 id="todayPrescriptions">8</h3>
                        <span>Today's Prescriptions</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon pending">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-details">
                        <h3 id="pendingPrescriptions">3</h3>
                        <span>Pending Review</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon templates">
                        <i class="fas fa-bookmark"></i>
                    </div>
                    <div class="stat-details">
                        <h3 id="savedTemplates">12</h3>
                        <span>Saved Templates</span>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions-section">
                <div class="content-card">
                    <div class="card-header">
                        <h5>Quick Actions</h5>
                    </div>
                    <div class="card-body">
                        <div class="quick-actions-grid">
                            <button class="quick-action-item" onclick="createNewPrescription()">
                                <div class="action-icon">
                                    <i class="fas fa-file-medical"></i>
                                </div>
                                <div class="action-content">
                                    <h6>New Prescription</h6>
                                    <span>Create from scratch</span>
                                </div>
                            </button>
                            <button class="quick-action-item" onclick="useTemplate()">
                                <div class="action-icon">
                                    <i class="fas fa-copy"></i>
                                </div>
                                <div class="action-content">
                                    <h6>Use Template</h6>
                                    <span>Start from template</span>
                                </div>
                            </button>
                            <button class="quick-action-item" onclick="viewPendingPrescriptions()">
                                <div class="action-icon">
                                    <i class="fas fa-hourglass-half"></i>
                                </div>
                                <div class="action-content">
                                    <h6>Pending Review</h6>
                                    <span>3 prescriptions waiting</span>
                                </div>
                            </button>
                            <button class="quick-action-item" onclick="manageTemplates()">
                                <div class="action-icon">
                                    <i class="fas fa-bookmark"></i>
                                </div>
                                <div class="action-content">
                                    <h6>Manage Templates</h6>
                                    <span>Edit saved templates</span>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Filters Section -->
            <div class="filters-section">
                <div class="row g-3 align-items-end">
                    <div class="col-md-3">
                        <label class="form-label">Date Range</label>
                        <input type="date" class="form-control" id="dateFilter">
                    </div>
                    <div class="col-md-2">
                        <label class="form-label">Status</label>
                        <select class="form-select" id="statusFilter">
                            <option value="">All Status</option>
                            <option value="active">Active</option>
                            <option value="completed">Completed</option>
                            <option value="cancelled">Cancelled</option>
                            <option value="pending">Pending</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label">Patient</label>
                        <select class="form-select" id="patientFilter">
                            <option value="">All Patients</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label">Department</label>
                        <select class="form-select" id="departmentFilter">
                            <option value="">All Departments</option>
                            <option value="cardiology">Cardiology</option>
                            <option value="orthopedics">Orthopedics</option>
                            <option value="pediatrics">Pediatrics</option>
                            <option value="neurology">Neurology</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-secondary" id="resetFilters">
                                <i class="fas fa-undo"></i> Reset
                            </button>
                            <button class="btn btn-primary" id="exportBtn">
                                <i class="fas fa-download"></i> Export
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Prescriptions List -->
            <div class="prescriptions-container">
                <div class="content-card">
                    <div class="card-header">
                        <h5>Recent Prescriptions</h5>
                        <div class="header-actions">
                            <button class="btn btn-sm btn-outline-primary" id="refreshBtn">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table prescriptions-table" id="prescriptionsTable">
                                <thead>
                                    <tr>
                                        <th>Prescription ID</th>
                                        <th>Patient</th>
                                        <th>Date</th>
                                        <th>Medications</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="prescriptionsTableBody">
                                    <tr>
                                        <td>Mr. Rohan Sharma</td>
                                        <td>Amoxicillin 500mg</td>
                                        <td>3 times daily</td>
                                        <td>7 days</td>
                                        <td><span class="badge bg-success">Active</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-primary">View</button>
                                            <button class="btn btn-sm btn-outline-secondary">Edit</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Mrs. Neha Kapoor</td>
                                        <td>Paracetamol 650mg</td>
                                        <td>2 times daily</td>
                                        <td>5 days</td>
                                        <td><span class="badge bg-warning">Pending</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-primary">View</button>
                                            <button class="btn btn-sm btn-outline-secondary">Edit</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Mr. Anil Verma</td>
                                        <td>Metformin 500mg</td>
                                        <td>Once daily</td>
                                        <td>30 days</td>
                                        <td><span class="badge bg-danger">Expired</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-primary">View</button>
                                            <button class="btn btn-sm btn-outline-secondary">Edit</button>
                                        </td>
                                    </tr>

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Create/Edit Prescription Modal -->
    <div class="modal fade" id="prescriptionModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="prescriptionModalTitle">Create New Prescription</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="prescriptionForm">
                        <!-- Patient Information Tab -->
                        <div class="prescription-tabs">
                            <ul class="nav nav-tabs" id="prescriptionTabs">
                                <li class="nav-item">
                                    <button class="nav-link active" id="patient-tab" data-bs-toggle="tab" data-bs-target="#patient-info" type="button">
                                        <i class="fas fa-user"></i> Patient Info
                                    </button>
                                </li>
                                <li class="nav-item">
                                    <button class="nav-link" id="diagnosis-tab" data-bs-toggle="tab" data-bs-target="#diagnosis-info" type="button">
                                        <i class="fas fa-stethoscope"></i> Diagnosis
                                    </button>
                                </li>
                                <li class="nav-item">
                                    <button class="nav-link" id="medications-tab" data-bs-toggle="tab" data-bs-target="#medications-info" type="button">
                                        <i class="fas fa-pills"></i> Medications
                                    </button>
                                </li>
                                <li class="nav-item">
                                    <button class="nav-link" id="followup-tab" data-bs-toggle="tab" data-bs-target="#followup-info" type="button">
                                        <i class="fas fa-calendar-plus"></i> Follow-up
                                    </button>
                                </li>
                            </ul>
                        </div>

                        <div class="tab-content" id="prescriptionTabContent">
                            <!-- Patient Info Tab -->
                            <div class="tab-pane fade show active" id="patient-info">
                                <div class="row g-3 mt-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Select Patient *</label>
                                        <select class="form-select" id="selectedPatient" required>
                                            <option value="">Choose a patient...</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Prescription Date *</label>
                                        <input type="date" class="form-control" id="prescriptionDate" required>
                                    </div>
                                    <div class="col-12" id="patientDetails">
                                        <!-- Patient details will be displayed here -->
                                    </div>
                                </div>
                            </div>

                            <!-- Diagnosis Tab -->
                            <div class="tab-pane fade" id="diagnosis-info">
                                <div class="row g-3 mt-3">
                                    <div class="col-12">
                                        <label class="form-label">Chief Complaint</label>
                                        <textarea class="form-control" id="chiefComplaint" rows="2" placeholder="Patient's main symptoms or concerns..."></textarea>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">Diagnosis *</label>
                                        <textarea class="form-control" id="diagnosis" rows="3" placeholder="Primary and secondary diagnosis..." required></textarea>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">ICD-10 Code</label>
                                        <input type="text" class="form-control" id="icdCode" placeholder="e.g., I10 (Essential hypertension)">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Severity</label>
                                        <select class="form-select" id="severity">
                                            <option value="">Select severity</option>
                                            <option value="mild">Mild</option>
                                            <option value="moderate">Moderate</option>
                                            <option value="severe">Severe</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Medications Tab -->
                            <div class="tab-pane fade" id="medications-info">
                                <div class="mt-3">
                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                        <h6>Medications</h6>
                                        <button type="button" class="btn btn-outline-primary btn-sm" id="addMedicationBtn">
                                            <i class="fas fa-plus"></i> Add Medication
                                        </button>
                                    </div>
                                    <div id="medicationsList">
                                        <!-- Medications will be added here -->
                                    </div>
                                </div>
                            </div>

                            <!-- Follow-up Tab -->
                            <div class="tab-pane fade" id="followup-info">
                                <div class="row g-3 mt-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Follow-up Required</label>
                                        <select class="form-select" id="followupRequired">
                                            <option value="no">No follow-up required</option>
                                            <option value="yes">Yes, schedule follow-up</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6" id="followupDateContainer" style="display: none;">
                                        <label class="form-label">Follow-up Date</label>
                                        <input type="date" class="form-control" id="followupDate">
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">Lab Tests Recommended</label>
                                        <textarea class="form-control" id="labTests" rows="3" placeholder="List any recommended lab tests or investigations..."></textarea>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">Instructions for Patient</label>
                                        <textarea class="form-control" id="instructions" rows="4" placeholder="Special instructions, dietary advice, activity restrictions, etc..."></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-outline-primary" id="previewPrescriptionBtn">Preview</button>
                    <button type="button" class="btn btn-primary" id="savePrescriptionBtn">Save Prescription</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Prescription Preview Modal -->
    <div class="modal fade" id="prescriptionPreviewModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Prescription Preview</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="prescriptionPreview" class="prescription-preview">
                        <!-- Preview content will be generated here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-outline-primary" id="downloadPdfBtn">
                        <i class="fas fa-download"></i> Download PDF
                    </button>
                    <button type="button" class="btn btn-primary" id="emailPrescriptionBtn">
                        <i class="fas fa-envelope"></i> Email to Patient
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Templates Modal -->
    <div class="modal fade" id="templatesModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Prescription Templates</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="templates-grid" id="templatesGrid">
                        <!-- Templates will be loaded here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="loading-text">Loading prescriptions...</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../js/prescriptions.js"></script>
</body>
</html>